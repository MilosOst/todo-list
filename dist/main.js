(()=>{"use strict";function e(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function t(t){e(1,arguments);var o=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===o?new Date(t.getTime()):"number"==typeof t||"[object Number]"===o?new Date(t):("string"!=typeof t&&"[object String]"!==o||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function o(o){e(1,arguments);var s=t(o);return s.setHours(0,0,0,0),s}function s(t,s){e(2,arguments);var r=o(t),a=o(s);return r.getTime()===a.getTime()}function r(t){return e(1,arguments),s(t,Date.now())}function a(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function n(o,s){e(2,arguments);var r=t(o),n=a(s);return isNaN(n)?new Date(NaN):n?(r.setDate(r.getDate()+n),r):r}function c(t){return e(1,arguments),s(t,n(Date.now(),1))}function i(o,s){e(1,arguments);var r=s||{},n=r.locale,c=n&&n.options&&n.options.weekStartsOn,i=null==c?0:a(c),d=null==r.weekStartsOn?i:a(r.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=t(o),l=u.getDay(),m=(l<d?7:0)+l-d;return u.setDate(u.getDate()-m),u.setHours(0,0,0,0),u}function d(t,o,s){e(2,arguments);var r=i(t,s),a=i(o,s);return r.getTime()===a.getTime()}class u{constructor(e){this.name=e,this.tasks=[]}addTask(e){this.tasks.push(e)}removeTask(e){const t=this.tasks.findIndex((t=>t.id===e));this.tasks.splice(t,1)}getTasks(){return this.tasks}setTasks(e){this.tasks=e}getTodayTasks(){return this.tasks.filter((e=>r(e.getDate())))}getTomorrowTasks(){return this.tasks.filter((e=>c(e.getDate())))}getThisWeekTasks(){return this.tasks.filter((t=>{const o=t.getDate();return function(t,o){return e(1,arguments),d(t,Date.now(),o)}(o)&&!r(o)&&!c(o)}))}sortTasksByPriority(){this.tasks.sort(((e,t)=>e.priority<t.priority?1:-1))}}var l,m=new Uint8Array(16);function p(){if(!l&&!(l="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(m)}const g=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,y=function(e){return"string"==typeof e&&g.test(e)};for(var k=[],h=0;h<256;++h)k.push((h+256).toString(16).substr(1));const T=function(e,t,o){var s=(e=e||{}).random||(e.rng||p)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){o=o||0;for(var r=0;r<16;++r)t[o+r]=s[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(k[e[t+0]]+k[e[t+1]]+k[e[t+2]]+k[e[t+3]]+"-"+k[e[t+4]]+k[e[t+5]]+"-"+k[e[t+6]]+k[e[t+7]]+"-"+k[e[t+8]]+k[e[t+9]]+"-"+k[e[t+10]]+k[e[t+11]]+k[e[t+12]]+k[e[t+13]]+k[e[t+14]]+k[e[t+15]]).toLowerCase();if(!y(o))throw TypeError("Stringified UUID is invalid");return o}(s)};class f{constructor(e,t,o,s){this.title=e,this.description=t,this.dueDate=o,this.priority=s||0,this.id=T()}updateInfo(e,t,o,s){this.title=e,this.description=t,this.dueDate=o,this.priority=s}getDate(){return new Date(this.dueDate)}}class j{constructor(){this.projects=[]}getProject(e){return this.projects.find((t=>t.name===e))}getProjects(){return this.projects}setProjects(e){this.projects=e}addProject(e){this.projects.push(e)}removeProject(e){const t=this.projects.findIndex((t=>t.name===e));this.projects.splice(t,1)}projectNameTaken(e){return this.projects.some((t=>t.name.toLowerCase()===e.toLowerCase()))}getTodayTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getTodayTasks()))),e}getTomorrowTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getTomorrowTasks()))),e}getWeeklyTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getThisWeekTasks()))),e}}class S{static updateTodoList(e){localStorage.setItem("todoList",JSON.stringify(e))}static getTodoList(){const e=Object.assign(new j,JSON.parse(localStorage.getItem("todoList")));return e.setProjects(e.getProjects().map((e=>Object.assign(new u,e)))),e.getProjects().forEach((e=>e.setTasks(e.getTasks().map((e=>Object.assign(new f,e)))))),e}static addProject(e){const t=S.getTodoList();t.addProject(new u(e)),S.updateTodoList(t)}static removeProject(e){const t=S.getTodoList();t.removeProject(e),S.updateTodoList(t)}static addTask(e,t){const o=S.getTodoList();o.getProject(t).addTask(e),S.updateTodoList(o)}static removeTask(e,t){const o=S.getTodoList();o.getProject(t).removeTask(e),S.updateTodoList(o)}}class v{static loadHomePage(){v.loadProjects(),v.loadHomePageTasks(),v.initMenuButtons(),v.initFormButtons()}static loadProjects(){const e=document.querySelector(".projects-scrollbar");e.textContent="",S.getTodoList().getProjects().forEach((t=>{e.appendChild(v.createProject(t))}))}static loadHomePageTasks(){const e=document.querySelector(".tasks-section");e.dataset.project="home",e.textContent="",e.append(v.createSection("today","Today",S.getTodoList().getTodayTasks()),v.createSection("tomorrow","Tomorrow",S.getTodoList().getTomorrowTasks()),v.createSection("weekly","Rest of Week",S.getTodoList().getWeeklyTasks()))}static loadProject(e){const t=S.getTodoList().getProject(e),o=document.querySelector(".tasks-section");o.dataset.project=e,o.textContent="",o.append(v.createSection("today","Today",t.getTodayTasks()),v.createSection("tomorrow","Tomorrow",t.getTomorrowTasks()),v.createSection("weekly","Rest of Week",t.getThisWeekTasks()))}static createProject(e){const t=document.createElement("div");return t.classList.add("project-entry"),t.dataset.name=e.name,t.innerHTML=`<h5 class='project-name'>${e.name}</h5>`,t.addEventListener("click",(e=>{const t=e.target.dataset.name;v.loadProject(t)})),t}static createSection(e,t,o){const s=document.createElement("div");return s.classList.add(`${e}-section`),s.innerHTML=`\n        <div class="tasks-header">\n        <h2 class="date-header">${t}</h2>\n            <div class="tasks-progress">\n                <p>0/7</p>\n            </div>\n        </div>`,s.appendChild(v.createTasks(o)),s}static createTasks(e){const t=document.createElement("ul");return t.classList.add("tasks"),e.forEach((e=>{const o=document.createElement("li");o.textContent=e.title,o.dataset.id=e.id,t.appendChild(o)})),t}static initFormButtons(){const e=document.querySelector("#select-project"),t=document.querySelector("#select-task");e.addEventListener("click",v.toggleForm),t.addEventListener("click",v.toggleForm),document.querySelector("#add-btn").addEventListener("click",(()=>{v.loadFormInfo(),document.querySelector(".add-modal").style.display="flex"})),document.querySelector(".close-btn").addEventListener("click",(()=>{document.querySelector(".add-modal").style.display="none"})),document.querySelector("#add-project").onsubmit=v.handleProjectFormSubmit,document.querySelector("#add-task").onsubmit=v.handleTaskFormSubmit}static initMenuButtons(){document.querySelector("#home-btn").addEventListener("click",v.loadHomePageTasks)}static toggleForm(){this.classList.contains("selected")||("select-project"===this.id?(this.classList.add("selected"),document.querySelector("#add-project").style.display="flex",document.querySelector("#add-task").style.display="none",document.querySelector("#select-task").classList.remove("selected")):"select-task"===this.id&&(this.classList.add("selected"),document.querySelector("#add-task").style.display="flex",document.querySelector("#add-project").style.display="none",document.querySelector("#select-project").classList.remove("selected")))}static loadFormInfo(){const e=S.getTodoList().getProjects(),t=document.querySelector("#project-select");t.textContent="",e.forEach((e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,t.appendChild(o)}))}static handleProjectFormSubmit(e){e.preventDefault();const t=e.target.querySelector("#project-name").value;S.getTodoList().projectNameTaken(t)?document.querySelector("#project-name-error").textContent="Project name is already in use.":(S.addProject(t),v.cleanAddForm(),document.querySelector(".add-modal").style.display="none",v.loadProjects())}static handleTaskFormSubmit(e){e.preventDefault();const t=v.createTaskFromForm(),o=document.querySelector("#project-select").value;S.addTask(t,o),v.cleanAddForm(),document.querySelector(".add-modal").style.display="none";const s=document.querySelector(".tasks-section").dataset.project;"home"===s?v.loadHomePageTasks():v.loadProject(s)}static cleanAddForm(){const e=document.querySelector("#add-project"),t=document.querySelector("#add-task");e.reset(),t.reset(),document.querySelectorAll(".error-message").forEach((e=>e.textContent=""))}static createTaskFromForm(){return new f(document.querySelector("#task-name").value,document.querySelector("#task-description").value,new Date(document.querySelector("#task-due-date").value+"T00:00:00"),document.querySelector("#task-priority").value)}}document.querySelector(".menu-toggle").addEventListener("click",(()=>{document.querySelector(".menu").classList.toggle("menu-open")})),v.loadHomePage()})();