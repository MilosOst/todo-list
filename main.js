(()=>{"use strict";function e(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function t(t){e(1,arguments);var o=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===o?new Date(t.getTime()):"number"==typeof t||"[object Number]"===o?new Date(t):("string"!=typeof t&&"[object String]"!==o||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function o(o){return e(1,arguments),t(o).getTime()<Date.now()}function s(o){e(1,arguments);var s=t(o);return s.setHours(0,0,0,0),s}function a(t,o){e(2,arguments);var a=s(t),r=s(o);return a.getTime()===r.getTime()}function r(t){return e(1,arguments),a(t,Date.now())}function n(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function c(o,s){e(2,arguments);var a=t(o),r=n(s);return isNaN(r)?new Date(NaN):r?(a.setDate(a.getDate()+r),a):a}function i(t){return e(1,arguments),a(t,c(Date.now(),1))}function d(o,s){e(1,arguments);var a=s||{},r=a.locale,c=r&&r.options&&r.options.weekStartsOn,i=null==c?0:n(c),d=null==a.weekStartsOn?i:n(a.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=t(o),u=l.getDay(),m=(u<d?7:0)+u-d;return l.setDate(l.getDate()-m),l.setHours(0,0,0,0),l}function l(t,o,s){e(2,arguments);var a=d(t,s),r=d(o,s);return a.getTime()===r.getTime()}function u(t,o){return e(1,arguments),l(t,Date.now(),o)}class m{constructor(e){this.name=e,this.tasks=[]}addTask(e){this.tasks.push(e)}hasTask(e){return this.tasks.find((t=>t.id===e))}removeTask(e){const t=this.tasks.findIndex((t=>t.id===e));this.tasks.splice(t,1)}getTasks(){return this.tasks}setTasks(e){this.tasks=e}getTodayTasks(){return this.tasks.filter((e=>r(e.getDate())))}getTomorrowTasks(){return this.tasks.filter((e=>i(e.getDate())))}getThisWeekTasks(){return this.tasks.filter((e=>{const t=e.getDate();return u(t)&&!(r(t)||i(t)||o(t))}))}getRemainingTasks(){return this.tasks.filter((e=>{const t=e.getDate();return o(t)&&!r(t)||!(i(t)||u(t))}))}sortTasksByPriority(){this.tasks.sort(((e,t)=>e.priority<t.priority?1:-1))}}var g,p=new Uint8Array(16);function k(){if(!g&&!(g="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(p)}const y=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,T=function(e){return"string"==typeof e&&y.test(e)};for(var h=[],S=0;S<256;++S)h.push((S+256).toString(16).substr(1));const f=function(e,t,o){var s=(e=e||{}).random||(e.rng||k)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){o=o||0;for(var a=0;a<16;++a)t[o+a]=s[a];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase();if(!T(o))throw TypeError("Stringified UUID is invalid");return o}(s)};class j{constructor(e,t,o,s){this.title=e,this.description=t,this.dueDate=o,this.priority=s||0,this.isCompleted=!1,this.id=f()}updateInfo(e,t,o,s,a){this.title=e,this.description=t,this.dueDate=o,this.priority=s,this.isCompleted=a}getDate(){return new Date(this.dueDate)}getFormattedDate(){return new Date(this.dueDate).toDateString()}getFormFormatDate(){return this.getDate().toISOString().split("T")[0]}}class v{constructor(){this.projects=[]}getProject(e){return this.projects.find((t=>t.name===e))}getProjects(){return this.projects}setProjects(e){this.projects=e}addProject(e){this.projects.push(e)}deleteTask(e){for(let t of this.getProjects())t.hasTask(e)&&t.removeTask(e)}removeProject(e){const t=this.projects.findIndex((t=>t.name===e));this.projects.splice(t,1)}projectNameTaken(e){return this.projects.some((t=>t.name.toLowerCase()===e.toLowerCase()))}getTask(e){for(let t of this.getProjects())for(let o of t.getTasks())if(o.id===e)return o}getTodayTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getTodayTasks()))),e}getTomorrowTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getTomorrowTasks()))),e}getWeeklyTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getThisWeekTasks()))),e}getRemainingTasks(){const e=[];return this.getProjects().forEach((t=>e.push(...t.getRemainingTasks()))),e}}class q{static updateTodoList(e){localStorage.setItem("todoList",JSON.stringify(e))}static getTodoList(){const e=Object.assign(new v,JSON.parse(localStorage.getItem("todoList")));return e.setProjects(e.getProjects().map((e=>Object.assign(new m,e)))),e.getProjects().forEach((e=>e.setTasks(e.getTasks().map((e=>Object.assign(new j,e)))))),e}static addProject(e){const t=q.getTodoList();t.addProject(new m(e)),q.updateTodoList(t)}static removeProject(e){const t=q.getTodoList();t.removeProject(e),q.updateTodoList(t)}static addTask(e,t){const o=q.getTodoList();o.getProject(t).addTask(e),q.updateTodoList(o)}static editTask(e,t){const o=q.getTodoList();o.getTask(e).updateInfo(...t),q.updateTodoList(o)}static deleteTask(e){const t=q.getTodoList();t.deleteTask(e),q.updateTodoList(t)}static getTask(e){return q.getTodoList().getTask(e)}static removeTask(e,t){const o=q.getTodoList();o.getProject(t).removeTask(e),q.updateTodoList(o)}static clearStorage(){localStorage.clear()}}class L{static loadHomePage(){L.loadProjects(),L.loadHomePageTasks(),L.initMenuButtons(),L.initFormButtons()}static loadProjects(){const e=document.querySelector(".projects-scrollbar");e.textContent="",q.getTodoList().getProjects().forEach((t=>{e.appendChild(L.createProject(t))}))}static loadHomePageTasks(){const e=document.querySelector(".tasks-section");e.dataset.project="home",e.textContent="",e.append(L.createSection("today","Today",q.getTodoList().getTodayTasks()),L.createSection("tomorrow","Tomorrow",q.getTodoList().getTomorrowTasks()),L.createSection("weekly","Rest of Week",q.getTodoList().getWeeklyTasks()),L.createSection("remaining","Remaining",q.getTodoList().getRemainingTasks()))}static loadProject(e){const t=q.getTodoList().getProject(e),o=document.querySelector(".tasks-section");o.dataset.project=e,o.textContent="",o.append(L.createSection("today","Today",t.getTodayTasks()),L.createSection("tomorrow","Tomorrow",t.getTomorrowTasks()),L.createSection("weekly","Rest of Week",t.getThisWeekTasks()),L.createSection("remaining","Remaining",t.getRemainingTasks()))}static createProject(e){const t=document.createElement("div");t.classList.add("project-container");const o=document.createElement("img");o.src="./imgs/x.svg",o.alt="Delete",o.classList.add("del-project"),o.addEventListener("click",L.removeProject);const s=document.createElement("div");return s.classList.add("project-entry"),s.dataset.name=e.name,s.innerHTML=`<h5 class='project-name'>${e.name}</h5>`,s.addEventListener("click",(e=>{const t=e.target.dataset.name;L.loadProject(t)})),t.append(s,o),t}static createSection(e,t,o){const s=document.createElement("div");s.classList.add(`${e}-section`);const a=o.reduce(((e,t)=>e+t.isCompleted),0);return s.innerHTML=`\n        <div class="tasks-header">\n        <h2 class="date-header">${t}</h2>\n            <div class="tasks-progress">\n                <p>${a}/${o.length}</p>\n            </div>\n        </div>`,s.appendChild(L.createTasks(o)),s}static createTasks(e){const t=document.createElement("ul");return t.classList.add("tasks"),e.forEach((e=>{const s=document.createElement("li");e.isCompleted&&s.classList.add("completed"),s.innerHTML=`\n            <div class="info">\n                <h5 class='task-name'>${e.title}</h5>\n                <div class='due-date-section'>\n                    <img src='./imgs/calendar.svg' alt='Calendar Icon'>\n                    <span class='due-date'>${e.getFormattedDate()}</span>\n                </div>\n            </div>\n            <div class='btns'>\n                <img class='edit-btn' src='./imgs/more-horizontal.svg' alt='More Options'>\n                <img class='del-btn' src='./imgs/x.svg' alt='Delete'>\n            </div>\n            `,o(e.getDate())&&!r(e.getDate())&&s.querySelector(".due-date").classList.add("expired"),s.dataset.id=e.id,s.querySelector(".edit-btn").addEventListener("click",L.openEditForm),s.querySelector(".del-btn").addEventListener("click",L.removeTask),t.appendChild(s)})),t}static initFormButtons(){L.initAddFormButtons(),L.initEditFormButtons()}static initAddFormButtons(){const e=document.querySelector("#select-project"),t=document.querySelector("#select-task");e.addEventListener("click",L.toggleForm),t.addEventListener("click",L.toggleForm),document.querySelector("#add-btn").addEventListener("click",(()=>{L.loadFormInfo(),document.querySelector(".add-modal").style.display="flex"})),document.querySelector("#close-add").addEventListener("click",(()=>{document.querySelector(".add-modal").style.display="none"})),document.querySelector("#add-project").onsubmit=L.handleProjectFormSubmit,document.querySelector("#add-task").onsubmit=L.handleTaskFormSubmit}static initEditFormButtons(){document.querySelector("#close-edit").addEventListener("click",L.closeEditForm),document.querySelector("#edit-task").onsubmit=L.handleEditFormSubmit}static initMenuButtons(){document.querySelector(".menu-toggle").addEventListener("click",(()=>{document.querySelector(".menu").classList.toggle("menu-open")})),document.querySelector(".edit").addEventListener("click",(()=>{document.querySelectorAll(".del-btn").forEach((e=>e.classList.toggle("active"))),document.querySelectorAll(".del-project").forEach((e=>e.classList.toggle("active")))})),document.querySelector("#home-btn").addEventListener("click",L.loadHomePageTasks),document.querySelector("#clear-btn").addEventListener("click",L.clear)}static toggleForm(){this.classList.contains("selected")||("select-project"===this.id?(this.classList.add("selected"),document.querySelector("#add-project").style.display="flex",document.querySelector("#add-task").style.display="none",document.querySelector("#select-task").classList.remove("selected")):"select-task"===this.id&&(this.classList.add("selected"),document.querySelector("#add-task").style.display="flex",document.querySelector("#add-project").style.display="none",document.querySelector("#select-project").classList.remove("selected")))}static loadFormInfo(){const e=q.getTodoList().getProjects(),t=document.querySelector("#project-select");t.textContent="",e.forEach((e=>{const o=document.createElement("option");o.value=e.name,o.textContent=e.name,t.appendChild(o)}))}static handleProjectFormSubmit(e){e.preventDefault();const t=e.target.querySelector("#project-name").value;q.getTodoList().projectNameTaken(t)?document.querySelector("#project-name-error").textContent="Project name is already in use.":(q.addProject(t),L.cleanAddForm(),document.querySelector(".add-modal").style.display="none",L.loadProjects())}static handleTaskFormSubmit(e){e.preventDefault();const t=L.createTaskFromForm(),o=document.querySelector("#project-select").value;q.addTask(t,o),L.cleanAddForm(),document.querySelector(".add-modal").style.display="none";const s=document.querySelector(".tasks-section").dataset.project;"home"===s?L.loadHomePageTasks():L.loadProject(s)}static handleEditFormSubmit(e){e.preventDefault();const t=e.target.dataset.task;q.editTask(t,L.getEditFormData());const o=document.querySelector(".tasks-section").dataset.project;"home"===o?L.loadHomePageTasks():L.loadProject(o),L.closeEditForm()}static getEditFormData(){return[document.querySelector("#edit-task-name").value,document.querySelector("#edit-task-description").value,document.querySelector("#edit-task-due-date").value+"T00:00:00",document.querySelector("#edit-task-priority").value,document.querySelector("#task-completed").checked]}static cleanAddForm(){const e=document.querySelector("#add-project"),t=document.querySelector("#add-task");e.reset(),t.reset(),document.querySelectorAll(".error-message").forEach((e=>e.textContent=""))}static createTaskFromForm(){return new j(document.querySelector("#task-name").value,document.querySelector("#task-description").value,new Date(document.querySelector("#task-due-date").value+"T00:00:00"),document.querySelector("#task-priority").value)}static openEditForm(e){document.querySelector(".edit-modal").style.display="flex";const t=e.target.parentElement.parentElement.dataset.id;document.querySelector("#edit-task").dataset.task=t;const o=q.getTask(t);L.loadEditFormData(o)}static closeEditForm(){document.querySelector(".edit-modal").style.display="none",document.querySelector("#edit-task").dataset.task=""}static loadEditFormData(e){const t=document.querySelector("#edit-task-name"),o=document.querySelector("#edit-task-description"),s=document.querySelector("#edit-task-due-date"),a=document.querySelector("#edit-task-priority"),r=document.querySelector("#task-completed");t.value=e.title,o.value=e.description,s.value=e.getFormFormatDate(),a.value=e.priority,r.checked=e.isCompleted}static removeTask(e){const t=e.target.parentElement.parentElement.dataset.id;q.deleteTask(t);const o=document.querySelector(".tasks-section").dataset.project;"home"===o?L.loadHomePageTasks():L.loadProject(o)}static removeProject(e){const t=e.target.previousSibling.dataset.name;q.removeProject(t),L.loadProjects(),L.loadHomePageTasks()}static clear(){q.clearStorage(),L.loadHomePage()}}L.loadHomePage()})();